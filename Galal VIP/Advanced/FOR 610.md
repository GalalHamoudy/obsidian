
### **If you need to produce a formal report, here's one way to structure it :**
- Summary of the analysis
- Identification (IOCs)
- Characteristics (consider MAEC Malware Capabilities or Malware Behavior Catalog)
- Dependencies
- Behavioral and code analysis findings
- Supporting figures
- Incident recommendations

---- [see malware analysis formal report]

**Beaconing**: Sending brief periodic messages to the adversary with basic information about the state of the malicious program and its infected host.
**Command and control (abbreviated as C2 or C&C)**: Obtaining instructions from the adversary regarding actions that the specimen needs to perform, such as upgrade itself or scan a host.
**Exfiltration**: Sending stolen data, such as keystroke logs, to the adversary.


**K> pestr file.exe       ........ like strings**
**K> peframe file.exe  ........ like peStudio**
**K> diec file.exe         ....... like detect it easy**



- Summary of the analysis: Key takeaways the reader should get from the report regarding the specimen's nature, origin, capabilities, and other relevant characteristics.
- Identification: The type of the file, its name, size, hashes (such as SHA256), malware names (if known), and current antivirus detection capabilities.
- Characteristics: The specimen's capabilities for infecting files, self-preservation, spreading, leaking data, interacting with the attacker, and so on. For a good reference of what characteristics you may need to capture, take a look at the MAEC Malware Capabilities project at https://for610.com/maec or the alternative effort Malware Behavior Catalog (MBC) at https://for610.com/mbc.
- Dependencies: Files and network resources related to the specimen's functionality, such as supported OS versions and required initialization files, custom DLLs, executables, URLs, and scripts.
- Behavioral and code analysis findings: Overview of the analyst's behavioral, as well as static and dynamic code analysis observations.
- Supporting figures: Logs, screenshots, string excerpts, function listings, and other exhibits that support the investigator's analysis.
- Incident recommendations: Indicators for detecting the specimen on other systems and networks, and possible for eradication steps.

---

[Speakeasy](https://github.com/mandiant/speakeasy) is a free, open-source emulator released by FireEye. It's "designed to emulate Windows kernel and user mode malware."
`run_speakeasy.py -t brbbot.exe -o speakeasy.json 2> speakeasy.txt`


We use **jq** tool to deal with .json file.

The Malware Behavior Catalog (MBC) is a catalog of malware objectives and behaviors, created to support malware analysis-oriented use cases, such as labeling, similarity analysis, and standardized reporting.
https://github.com/MBCProject/mbc-markdown

turn on the web server on REMnux by issuing the httpd start command in the REMnux terminal window.
turn off the web server on REMnux by issuing the httpd stop command in the REMnux terminal window.

### INetSim

**INetSim** can emulate many protocols, including HTTP, HTTPS, SMTP, FTP, POP3, TFTP, IRC, and more.

You can obtain a free copy of INetSim from https://inetsim.org. It is also installed on REMnux. Following are the REMnux locations of the important files that INetSim uses:

- /etc/inetsim/inetsim.conf is the main configuration file of INetSim. It enables you to define which services INetSim should emulate. It also enables you to define service-specific options, such as listening ports, static DNS mappings, HTTP response parameters, SSL configuration details, and so on.
- /var/log/inetsim contains the INetSim log files. The most useful of these files is probably service.log, which contains details about the requests INetSim received and the responses it provided.
- /var/lib/inetsim contains data files used by INetSim emulators, such as the files provided by the HTTP emulator or the certificate used for SSL encryption for the HTTPS emulator.

To see the details of the connection established between ghyte.exe and INetSim's HTTPS emulator, examine INetSim's log file /var/log/inetsim/service.log by issuing this command on REMnux:
`sudo more /var/log/inetsim/service.log`



### Fiddler

- [Fiddler](https://www.telerik.com/download/fiddler) can intercept and display HTTP and HTTPS traffic from the client side on Windows.
- Its powerful proxy-like debugging capabilities are also useful when assessing web applications.
- If you don't have web services active on REMnux, you can use Fiddler's autoresponder to generate HTTP and HTTPS responses.


### iptables
iptables, which is a powerful Linux-based firewall software. Its capabilities include Network Address Translation (NAT), which we can use to intercept and redirect network connections going to all possible IP addresses.

To use iptables for such interception, your Windows virtual machine needs to be configured to point to the REMnux virtual machine's IP as its default gateway.
Activate iptables redirection using: accept-all-ips start

---
















