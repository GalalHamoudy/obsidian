-------------- [English] --------------

intrusions : الاختراقات 
Consuming : الاستهلاك
indicators : مؤشرات

-------------- [Sources and Tools] --------------

[MindMup](https://www.mindmup.com/) Free Online Mind Mapping to Create, share and publish mind maps.

[ThreatMiner](https://www.threatminer.org/) is a threat intelligence portal designed to enable analysts to research under a single interface.
was created To free analysts from data collection and provide intelligence analysts with a portal on which they can carry out their tasks, from reading reports to pivoting and data enrichment - all on a single portal.


---
## Lab 1.1 : structured analytic techniques (SATs)


In this lab, you will use two different types of structured analytic techniques (SATs). 

SATs are designed to help analysts perform analysis while abstracting themselves as much as possible from other influences such as bias. 
SATs can be leveraged for different types of analysis, including data organization, hypothesis generation, decision support, and conflict management. 

The SATs in this lab you will utilize are focused on data organization:  **Simple Brainstorming and Sorting**.

**Simple Brainstorming** is most often used at the beginning of a project to identify a list of [relevant variables, key drivers, sources of information, possible outcomes or solutions, and other information] that can get an analyst started thinking critically about a topic. The goal of brainstorming is to generate as many ideas as possible without beginning to apply analytic judgment during the process to avoid biases such as anchoring bias.

**example**: we have e-commerce > we write every things related to it and its important to take our care > we classified all the data into main points 

**Task** : Use Simple Brainstorming to identify relevant variables for research into ransomware attacks on the healthcare sector.

**Solve**: 
1- list the variables that will be useful to future research (at MindMup) 
2- we categorized all variables


**Sorting** is a way to structure and visualize variables of the topic you are looking into. It is a good technique for organizing
large bodies of data to generate insights. Sorting is most often done with a spreadsheet or database program so that data
can be sorted or organized in different ways. Sorting follows the general steps listed below:
- Step 1: Identify the variables or categories of a topic using a brainstorming method.
- Step 2: Make these categories column headers in a spreadsheet.
- Step 3: List facts, pieces of information, or hypotheses related to the categories in the appropriate column.
- Step 4: Review the sorted data for trends or anomalies and list them out as either findings or areas to look into more.
- Step 5: Review the findings, trends, and anomalies with others in your group; list and explain any variables you excluded or trends you discounted.

**example**: we use excel to write all data in table and categorized them into columns and rows .

Task : Use Sorting to identify relevant trends in phishing emails sent to the company. 

solve: 
1- we open task.csv file with excel 
2- in "Data" select "Sort" then select Expand the selection 
3- then we select which column to sort

---

## Lab 1.2: Consuming Along the Sliding Scale

The **Sliding Scale** of Cyber Security **Model** :
< 1 2 3 4 5 >
1- Architecture
2- passive defense
3- Active defense
4- intelligence
5- offense

the three applicable phases of the sliding scale:

- Architecture: Relates to the systems themselves, including a system of systems (such as networks) and their security. Design, supply chain, building, maintaining, etc., of the systems all fall into this category. An example would be including port mirroring on network switches to capture data, patching vulnerabilities, and generating new log types off systems for insight.
- Passive Defense: Relates to the systems placed on top of or in conjunction with other systems such as security tools. Anti-malware systems, endpoint protection, intrusion detection systems, log aggregators and analysis systems, and any other type of system or input into them that helps give visibility or performs automatic actions against adversaries and their capabilities.
- Active Defense: Relates to the human aspect of security against adversaries. Incident response, security operations, threat hunting, and other forms of reactive or proactive security where the human analyst is making decisions against the adversary or their capabilities.


Great! The **Sliding Scale of Cyber Security** is a conceptual model developed by **Robert M. Lee**, widely used in cyber threat intelligence and defense circles to illustrate the range of cybersecurity activities, from foundational defenses to offensive operations.
It presents cybersecurity as a **spectrum**, where different activities and capabilities **build on one another**, and are **increasingly sophisticated** from left to right:

###  **1. Architecture**

This is the **foundation** of cybersecurity.
- **Definition**: The design and implementation of secure systems and networks.
- **Focus**: Building systems with **security in mind** from the beginning (e.g., segmentation, least privilege, secure protocols).
- **Goal**: Prevent vulnerabilities and reduce attack surfaces.
- **Examples**:
    - Network segmentation
    - Secure software development lifecycle (SSDLC)
    - Access control models
    - Encryption standards

 Without good architecture, all other efforts are weakened.

###  **2. Passive Defense**

These are the **standard security tools and configurations** used to defend against known threats.
- **Definition**: Security measures that operate without active engagement with the threat actor.
- **Focus**: Automated and preventive controls.
- **Goal**: Detect and stop **known or generic threats**.
- **Examples**:
    - Firewalls
    - Antivirus
    - Intrusion detection systems (IDS)
    - Patch management
    - Security configurations (e.g., disabling unused ports)

 Limitations: Passive defenses are ineffective against advanced or novel threats.

###  **3. Active Defense**

Here, defenders begin to **interact with and respond to threats** in real-time.
- **Definition**: Proactive monitoring, deception, and threat hunting efforts.
- **Focus**: Detecting, analyzing, and mitigating **active adversaries** in the environment.
- **Goal**: Detect and remove intruders before they cause damage.
- **Examples**:
    - Threat hunting
    - Honeypots and deception technologies
    - Behavioral analysis
    - Incident response teams
    - Security Operations Centers (SOCs)

 This is the "art of cyber defense" — dynamic, adaptive, and crucial against sophisticated threats.

###  **4. Intelligence**

This is where defenders use **knowledge about adversaries** to drive decision-making.
- **Definition**: Collection, analysis, and application of threat intelligence (TI).
- **Focus**: Understanding **who** the threat actors are, **how** they operate, and **why** they attack.
- **Goal**: Enable **anticipatory** and strategic defense.
- **Examples**:
    - Indicator of Compromise (IOC) feeds
    - Tactics, Techniques, and Procedures (TTP) analysis (MITRE ATT&CK)
    - Attribution to threat actors/groups
    - Strategic threat reports (APT group activity, geopolitical context)

 Intelligence feeds both active defense and strategic planning. It enables defenders to move from being reactive to **proactive**.

###  **5. Offense**

This is the realm of **cyber operations**, typically conducted by **nation-states or specialized groups**.
- **Definition**: Activities that go beyond defense — aiming to **disrupt, degrade, or destroy** adversary systems.
- **Focus**: Exploitation, attack, and counter-operations.
- **Goal**: Achieve strategic or tactical advantage.
- **Examples**:
    - Exploit development
    - Penetration of adversary infrastructure
    - Red teaming (offensive emulation)
    - Government offensive cyber operations (e.g., Stuxnet)

 Offensive capabilities are rare and highly regulated; not typically part of commercial cybersecurity.

###  Putting It All Together

- The **left side (1-2)** is about **prevention** and system integrity.
- The **middle (3-4)** is where **real-time defense** and **strategic insight** occur.
- The **right side (5)** is where **nations and specialized actors** operate offensively.

---

## Lab 1.3: Enriching and Understanding Limitation

collect information from OSINT using google dorks and Threat Miner  

[ThreatMiner](https://www.threatminer.org/) is a threat intelligence portal designed to enable analysts to research under a single interface.
was created To free analysts from data collection and provide intelligence analysts with a portal on which they can carry out their tasks, from reading reports to pivoting and data enrichment - all on a single portal.

[Google Dorks](https://www.recordedfuture.com/threat-intelligence-101/threat-analysis-techniques/google-dorks): Top Tips and Tricks for Advanced Search Intelligence

---

## Lab 1.4: Strategic Threat Modeling

Develop a threat model 
1- from sources , identify priority intelligence requirements (PIRs)
2- brainstorming , sorting and documenting all findings
3- create MindMup with the company name and data sources (company information)
4- add all threats which has targeted the company before and linked it with the data sources (company information) which have been targeted 
5- add all threats which target the same company sector , then add thier tools and TTPs 

---

**==Priority Intelligence Requirements (PIRs)==** are a core concept in threat intelligence and are used to **focus intelligence efforts** on what matters most to decision-makers.

###  **Definition:**

> **Priority Intelligence Requirements (PIRs)** are **high-level questions** that guide the collection and analysis of threat intelligence to support specific business or security objectives.

They help threat intelligence teams prioritize [**what to collect**, **who to monitor**, and **why it matters**].

###  **Purpose of PIRs:**

- Align intelligence with business and security needs
- Avoid information overload
- Focus limited resources on the most relevant threats
- Support decision-making during operations or investigations

###  **What Makes a Good PIR?**

A good PIR is:
- **Specific**: Focused on a threat, actor, asset, or behavior
- **Actionable**: The answer helps make a decision
- **Relevant**: Tied to the organization's risk or mission
- **Clear**: Easy to understand and measurable

###  **Examples of PIRs:**

1. **"What APT groups are targeting our industry sector?"**
    - Helps security leadership plan defensive posture.
2. **"Are there any credible threats to our upcoming product launch?"**
    - Supports risk management and executive protection.
3. **"What TTPs are being used to exploit our VPN infrastructure?"**
    - Guides detection and hunting.
4. **"Have any of our credentials appeared on dark web forums?"**
    - Triggers remediation actions (e.g., password resets).

###  **PIRs Are Not Static**

PIRs should be **reviewed and updated regularly** based on:
- Changes in business priorities
- Evolving threat landscape
- New vulnerabilities or incidents

###  **PIRs in a Threat Intelligence Lifecycle**

They are part of the **Planning & Direction** phase and drive:
1. **Collection** → Gather relevant data
2. **Processing & Analysis** → Turn data into insights
3. **Dissemination** → Deliver intelligence that answers the PIRs
4. **Feedback** → Evaluate and adjust PIRs as needed

---

Creating **Strategic Threat Modeling** is a high-level, **intelligence-driven process** that helps organizations understand and anticipate **who might attack**, **why**, and **how**, so they can make better **strategic decisions**.

Unlike technical threat modeling (focused on systems or apps), **strategic threat modeling** focuses on:
- **Adversary motivations & capabilities**
- **Organizational risk and mission**
- **Long-term planning**

##  ==Steps to Create Strategic Threat Modeling==

Here’s a practical, structured approach in **7 steps**:

### **1. Define Business & Strategic Objectives**

Start by understanding the **organization’s mission**, critical assets, and key goals.

 Questions to ask:
- What is the organization's core mission or service?
- What are the most valuable assets (data, systems, reputation)?
- What regulations or legal exposures exist?

 **Goal**: Align security with business risk.

### **2. Identify the Threat Surface (Strategically)**

Map the **broad attack surface** from a strategic lens.

This includes:
- Geographic locations
- Supply chain or third-party partners
- Executive personnel
- Digital footprint (e.g., brand presence, cloud assets)

 **Goal**: Understand where strategic risk exists.

### **3. Define Potential Adversaries**

Use threat intelligence to identify **who** would target the organization and **why**.

Include:
- **Nation-states**
- **Cybercriminal groups**
- **Hacktivists**
- **Insider threats**

Use frameworks like:
- MITRE ATT&CK for TTPs
- Threat actor profiles
- Industry-specific threat reports

 **Goal**: Create adversary profiles relevant to your sector and region.

### **4. Understand Adversary Motivations & Objectives**

Now determine the **“why”** behind attacks:
- Financial gain
- Espionage
- Disruption
- Ideological motives
- Competitive advantage

Map this to **organizational impact** (e.g., data theft, service disruption, reputational damage).

 **Goal**: Anticipate what attackers want and why they might come after you.

### **5. Map Adversary Capabilities & TTPs**

Identify the **tools, techniques, and procedures (TTPs)** your adversaries use.

Resources:
- MITRE ATT&CK mapping
- Past incident analysis
- Threat intelligence feeds

Focus on:
- How initial access is gained
- How persistence is maintained
- How exfiltration occurs

 **Goal**: Know how adversaries operate, and where you are most vulnerable.

### **6. Assess Organizational Gaps & Risk**

Now compare **threat capabilities** to your **current defenses**.

Do a **gap analysis**:
- Are there key detection gaps?
- Are response plans in place for high-risk scenarios?
- Are business leaders aware of these threats?

Use tools like:

- Risk matrices
- Cyber Kill Chain or ATT&CK flow
- SWOT (Strengths, Weaknesses, Opportunities, Threats)

🎯 **Goal**: Prioritize mitigation, investment, or policy shifts.

### **7. Build Strategic Scenarios & Courses of Action**

Now turn the intelligence into **actionable strategic plans**.
- Build **threat scenarios** (e.g., ransomware by a criminal group or cyberespionage by a nation-state)
- Define **likely attack paths**
- Recommend **strategic responses**:
    - Investment in new tech
    - Executive awareness
    - Supply chain review
    - Red teaming

 **Goal**: Provide leadership with clear, forward-looking options to reduce risk.

##  Tools, Frameworks & Models That Help

|Tool/Framework|Use in Strategic Threat Modeling|
|---|---|
|**MITRE ATT&CK**|Maps adversary behaviors & capabilities|
|**Cyber Kill Chain**|Tracks stages of an attack|
|**Diamond Model**|Analyzes adversary, infrastructure, capability, victim|
|**STIX/TAXII**|Structured threat data exchange|
|**PIRs**|Guides intelligence collection to inform strategy|

##  Output: What Should You Deliver?

A solid **Strategic Threat Model** typically results in:
- **Adversary profiles** (intent, capability, history)
- **Threat landscape summary** relevant to your org
- **Key risks and gaps**
- **Threat scenarios**
- **Recommendations for leadership**

---
## Lab 2.3: Pivoting to Memory with Indicators

we use **netscan** plugin in volatility to check network communications.
and we use **timeliner** plugin to create a timeline very accurate.
and **pslist** to get all process.
One plugin we can use is **malfind**, which looks for suspicious activity such as code that looks like executables such as DLLs or shellcode inside of running processes.
to see any handles in the process we use handles plugin and focus on the PID of the process 

---

What defines a capable CTI analyst? A CTI analyst can:
- Fully analyze successful and unsuccessful intrusions by targeted threat actors
- Construct descriptions of campaigns, actors, and organizations
- Seek out, collect, and properly exploit intelligence from others
- Generate intelligence from their own data sources and share it accordingly
- Manage intelligence to further the objectives of their organizations


Case Study : Moonlight Maze
- targeting government and military networks
- Russian hackers steal us weapons secret
- after discover the malware, the authors developed their toolkit based off LOKI2 "Penquin Turla" 


**Intelligence** is the collection, processing, and analysis of information about a competitive entity and its agents, needed by an organization or group for its security and well-being.
**Intelligence** is both a product and a process.


### Analysis Approaches in CTI

#### Data-Driven Analysis
- **Characteristics**:
  - Relies on high-quality datasets
  - Best for well-defined, straightforward problems
- **Accuracy Factors**:
  - Dependent on dataset accuracy and completeness
  - Results can be verified through dataset examination
- **Key Advantages**:
  - Logically-driven process
  - Easily replicated by other analysts
  - Transparent methodology

#### Conceptually-Driven Analysis
- **Characteristics**:
  - Deals with ambiguous situations
  - Handles undefined variables and relationships
- **Accuracy Factors**:
  - Relies on analyst's mental models
  - Improves through iterative feedback
- **Key Advantages**:
  - Enables rapid interpretation of complex concepts
  - Adaptable to novel threat scenarios
  - Valuable when data is limited

#### Application in CTI
- **Data-Driven**: Best for technical IOCs (IPs, hashes), malware analysis
- **Conceptually-Driven**: Essential for strategic threat assessments, adversary modeling

Tip: Effective CTI programs combine both approaches - using data-driven methods for tactical analysis and conceptually-driven methods for strategic insights.


 "التحليل التحكيمي" أو **Analytic Judgment** :

المقصود هنا إن دور المحلل مش مجرد إنه يجمع معلومات عن حادث أو جهة معينة ويعرضها كحقائق، لكن عليه إنه يحلل ويفهم معنى المعلومات وتأثيرها على الجهة اللي بيشتغل لصالحها. التقييم ده هو اللي بنسميه **"التحليل التحكيمي"**.
التحليل ده بيكون بهدف تلبية متطلبات استخباراتية محددة، وبيعتمد على البيانات والمعلومات المتوفرة – حتى لو فيها فجوات أو في حاجات مش مؤكدة. الأحكام أو التقييمات دي ممكن تكون عن أحداث حصلت في الماضي (زي تحليل هدف وتأثير هجوم معين)، أو عن أحداث مستقبلية (زي التوقع بتأثير إجراء معين – مثلاً حظر الاتصال مع أنظمة القيادة والسيطرة).
لكن من المهم نعرف إن الأحكام دي ممكن يكون فيها نسبة خطأ، عشان كده لازم نفهم إزاي المحلل وصل للحكم ده.
في أدوات وأساليب بتساعد المحلل إنه يعمل التحليل ده، زي **Heuer’s Analysis of Competing Hypotheses (ACH)** أو **Lewin’s Force Field Analysis**. الأدوات دي بتساعد في تقييم المعلومات الحالية، وتحديد المعلومات الناقصة، وتُظهر المنهجية اللي اتبعها المحلل، وبالتالي يقدر "يعرض شغله" ويوضح ليه أصدر الحكم ده.


- **Analytic Judgment** = Assessment of what info means and how it impacts the organization.
- Judgments are based on **available data** + **acknowledgement of gaps/uncertainty**.
- Can be about **past events** (e.g. attack goal) or **future impact** (e.g. response action).
- Judgments are **not free from human error** → must understand the reasoning behind them.
- **Structured methodologies** help:
    - Heuer’s **Analysis of Competing Hypotheses (ACH)**
    - **Lewin’s Force Field Analysis**
- These methods help:
    - **Assess info**
    - **Identify needed data**
    - **Highlight gaps**
    - **Show analyst’s reasoning ("show their work")**



---

###  **Types of Analysis That Lead to Analytic Judgments**

There are different types of analysis used in intelligence. There is no “one best method,” but some methods work better in certain situations. Two main types discussed here are:
**1. ==Data==-Driven Analysis**
**2. ==Conceptually==-Driven Analysis**

---

###  **1. Data-Driven Analysis**

- Based on existing data and pre-built models.
- Assumes the data and the model being used are accurate.
- Example: Virologists use data about viruses to predict how diseases will spread — intelligence analysts do similar things with military or political data.
- Models used: agent-based models, growth-matrix models, etc.
- Works well when there is **good, reliable data** available.
- Common use: analyze troop movements, assess military strength, or predict stability of governments.

---

###  **2. Conceptually-Driven Analysis**

- Used more often in intelligence work because **accurate data is often missing**.
- In these cases, the analyst uses **mental models or theories** to understand the situation.
- The problem usually has many variables, and it’s unclear which ones are important.
- This kind of analysis doesn’t always lead to clear answers — analysts often say “**It depends**.”
- Very useful in situations of **uncertainty** where judgment is critical.
- Important to watch for **biases** in this kind of analysis.
- Structured techniques are helpful to make the analysis stronger.

---

###  **Key Points to Remember**

- No single type of analysis fits all cases.
- **Data-driven analysis** works best with strong, accurate data.
- **Conceptually-driven analysis** is useful when data is missing or unclear.
- Both types have value — understanding when to use each is part of good intelligence work.

---


Structured Analytic Techniques
Structured analytic techniques (SATs) are tools to assist analysts at deriving better analysis through the
abstraction of their biases. SATs are divided into families depending on what part of the analytic process they
support. Almost all SATs include two key tasks:

Decomposition - Breaking down a problem into its components so they can be considered separately.
Visualization - Capturing the parts of a problem in an organized, often visual, manner to better understand
how the parts are interrelated and facilitate analysis. 

Request for Information (RFIs) generally describe a request by analysts focusing on one phase of the cycle for
more information from analysts in another phase of the cycle. This could include subject matter expertise in
areas unfamiliar to the requesting party, a clarification on processed data, or tasking to collect additional data, to
amplify analysis.

---


## CTI Terminology

These terms are used loosely throughout our industry, so they are often misunderstood. In this course, we adhere to the following definitions:

- **An adversary or threat** is a representation of the human behind the keyboard. It can be the individual, team, or a government. Defining what the specifics of a threat means requires different models (See: Threat Actor). The important understanding of a threat is that it is the entity involved in the execution of an intrusion. We use the term threat interchangeably with adversary. Note that a threat is not a vulnerability (as used in Microsoft's threat modeling, which really is modeling vulnerabilities), nor is it a tool (such as a piece of malicious code).
- **Intelligence requirement** is the simply worded and straightforward single question that drives the intelligence life cycle. It is easily thought of as a pain point or knowledge gap as it relates to the adversary that an organization seeks to satisfy.
- **An intrusion** is any successful or failed attempt by the adversary to compromise a system.
- **An intrusion set** is a term used to describe the linking of multiple intrusions together, usually when there are key indicator overlaps especially across 2+ phases of the kill chain.
- **An activity group** is a set of events and activity associated by similarities in their features and weighted by confidence scoring. Simply put, it is a clustering of intrusions with weighting on the Adversary, Infrastructure, Tradecraft (Capability/TTP), and/or Victim of the intrusions that meets some analytical requirement.
	- An intrusion set would be a clustering and linking of intrusions on key indicators, whereas an Activity Group is a cluster you're tracking that's specific to an analytical requirement or intelligence requirement. A slight nuance but Activity Groups are more formal and meet a more structured purpose.  
- A Threat Actor is the threat (person/team/organization/etc.) that is responsible for intrusions and is uniquely tracked across different intrusions. Simply put, it is a clustering of intrusions that focuses on an intelligence requirement to identify who is responsible for intrusions. That is, it is an attribution-based clustering. Attribution does not have to be true attribution (e.g., it's Russia) but can be an abstraction (e.g., FUZZYSNUGGLYDUCK) to continue to track the threat even when elements of their intrusions are not consistent or related in victims, tradecraft, or infrastructure.
- **A campaign or operation** is the adversary's mission focus, such as a malicious group of adversaries targeting financial networks.
- **TLP** is the Traffic Light Protocol and is a standard for information sharing that uses White, Green, Amber, and Red as banners to identify who information can be shared to.
- **A victim** is an individual, network, or system compromised in the course of achieving an objective.
- **A target** is the intended victim of an intrusion.
- **A persona** is the fake name or identifier that an adversary takes; it can be operated by one or more adversaries operating on the same or different groups.
- **A TTP stands for Tactic, Technique, and Procedure**. A tactic is the higher-level tradecraft that the adversary intends to use to reach an objective (e.g., compromise a domain controller to get passwords to target accounts). A technique is the manner to which the adversary is going to accomplish that tactic (e.g., leveraging a specific exploit to gain access to the domain controller). A procedure is the more granular approach to accomplishing the technique (e.g., the commands typed to launch the exploit).
- **Tradecraft** is the combination of methods, capabilities, and resources (such as infrastructure) that an adversary leverages in the course of their actions. TTPs and tradecraft can sometimes be interchanged, but there is a subtle difference. TTP is a grouping of the way adversaries complete their actions.
  Tradecraft is broader and can be thought of as the M.O. (modus operandi) of the adversary; not only the way they perform their actions, but what they choose to leverage in performing them. TTPs are often extended to include tradecraft elements, such as specific toolkits, but should not be. As an example, an adversary could leverage a phishing email to drop malicious code on a system (TTPs). The malicious code could be a specific backdoor that's leveraged and consistently identified in use by the adversary to gain access followed by a different set of TTPs. That is, tradecraft can be more specific but also include different clustering of TTPs (being broader in its application). Tradecraft most commonly aligns in our field to activity groups, as it may represent different clusters of intrusions that represent different aspects of TTPs.

---
### Intelligence Requirements
Intelligence requirements are the objectives that analysts seek to satisfy through the intelligence process. 
Our finalized intelligence products should meet those requirements and guide how we do the process such as collection, exploitation, and analysis of the data. 
an intelligence requirement is "A requirement for intelligence to fill a gap in the command's knowledge or understanding of the operational environment of threat forces." , or we'll use the definition: A knowledge gap that needs addressing to enable action.

Intelligence requirements need to be simple and support a single decision by decision makers. The focus on specific events, facts, and activity will also help avoid nebulous requirements such as "Will we be attacked?" It is a best practice to keep intelligence requirements visible to everyone on the team and make them visible to the consumers as well. We want our consumers to have direct input into the intelligence requirement process because it is a bad habit to let the intelligence team define these on their own-we are not the consumers of our own intelligence.


Intrusions

The core of all cyber threat intelligence is intrusion analysis. 
Intrusions are any attempt, successful or failed, that the adversary makes to compromise or attack systems. 
Even failed intrusions have a lot of information that we can gather for analysis.

source :
https://www.youtube.com/@SANSForensics/playlists

---

# Traffic Light Protocol (TLP) - Simple Explanation  

## Colors and When to Use Them  

### **RED**  
- **When to use**: For very sensitive information that could harm someone’s privacy, reputation, or work if shared wrongly.  
- **Sharing rule**: Only discuss it with the people directly involved. Do **not** share it with anyone else.  

### **AMBER**  
- **When to use**: For information that needs teamwork to act on but could still cause harm if shared too widely.  
- **Sharing rule**: Only share with people in your organization who **need to know** to help.  

### **GREEN**  
- **When to use**: For useful information that can be shared with trusted groups or partners in your field.  
- **Sharing rule**: Share with other organizations you work with, but **not** publicly (e.g., no social media or open websites).  

### **WHITE**  
- **When to use**: For safe, non-sensitive information that’s okay for everyone to see.  
- **Sharing rule**: Can be shared freely, but respect copyright rules.  

**TL;DR**:  
- **RED** = Only for the people in the room.  
- **AMBER** = Only for your team (if they need it).  
- **GREEN** = Share with trusted partners, but not publicly.  
- **WHITE** = Share anywhere.

---


**Traffic Light Protocol (TLP)** is a system used in threat intelligence to control how sensitive information is shared.

- **TLP:RED** – For named recipients only. No further sharing allowed.
- **TLP:AMBER** – Can be shared within your organization only.
- **TLP:AMBER+STRICT** – Can be shared only within a specific part of your organization.
- **TLP:GREEN** – Can be shared with peers and partner organizations, not publicly.
- **TLP:WHITE** – No restrictions. Can be shared publicly.


### ==Tradecraft==
- Tradecraft is the techniques, methods, and technologies leveraged by adversaries. Tactics and Procedures are not really the concern of tradecraft, although they are often clustered together in the field of CTI.
- An easy way to think of tradecraft is the collection of techniques adversaries use in combination with how they use them and what specific technologies they leverage, such as families of malware or styles of malicious software used. 
- As an example, an adversary's tradecraft might be the consistent use of macro-enabled Word documents to deliver a memory-only rootkit. TTPs would describe the tactic (persistence) and procedures (specifics of the macros) but wouldn't account for the family of the rootkit leveraged. 
- Tradecraft can include multiple sets of TTPs as well. As an example, an adversary that leverages the aforementioned rootkit and also performs VPN access into their targets to then leverage that rootkit would have two distinct sets of TTPs, although the adversary's tradecraft is to leverage them together.


Here’s a simple table comparing **Tradecraft** and **TTPs (Tactics, Techniques, and Procedures)** in the context of threat intelligence:

|**Aspect**|**Tradecraft**|**TTPs (Tactics, Techniques, and Procedures)**|
|---|---|---|
|**Definition**|The specific skills, tools, methods, and knowledge used by adversaries to execute cyber attacks.|A framework that describes the behavior and actions of cyber adversaries in stages, categorized by Tactics, Techniques, and Procedures.|
|**Focus**|Focuses on the tools, techniques, and behaviors used by specific threat actors to conduct operations.|Focuses on the broader classification of adversary actions throughout the attack lifecycle.|
|**Level of Detail**|Highly specific to an adversary group or campaign.|More general, describing patterns of behavior across many adversaries.|
|**Example**|- Use of spear-phishing emails with malicious attachments.|- Tactic: Initial Access. - Technique: Phishing. - Procedure: Spear-phishing with attachment.|
|**Scope**|More granular and operational, looking at specific attack methods.|Broader, categorizing different stages of an attack (e.g., initial access, execution, persistence).|
|**Usage**|Used to understand how specific attackers operate and their signature techniques.|Used to model the adversary’s full attack lifecycle and map out threats for detection, mitigation, and response.|
|**Context in Threat Intel**|Provides insight into the "how" of an attack.|Provides insight into the "what" (objective or goal) and "how" of an attack.|

### Key Takeaways:

- **Tradecraft** focuses more on the specifics of how adversaries do things, while **TTPs** provide a structured way to describe an adversary's methods and tactics at a broader level.
- TTPs help categorize the attack lifecycle, whereas tradecraft is about the detailed actions or artifacts of an attack.



---

### **The Indicator Life Cycle** in threat intelligence describes the process of managing **Indicators of Compromise (IOCs)** or **Indicators of Attack (IOAs)** — from creation to retirement. It ensures that indicators are relevant, actionable, and effectively used in detecting and responding to threats.


### 🔁 **Phases of the Indicator Life Cycle**

|**Phase**|**Description**|
|---|---|
|**1. Planning & Direction**|Define intelligence requirements and determine what types of indicators are needed.|
|**2. Collection**|Gather indicators from various sources (e.g., threat feeds, logs, malware analysis, intel reports).|
|**3. Processing**|Normalize, structure, and prepare collected data for analysis (e.g., parse logs, extract IOCs).|
|**4. Analysis & Production**|Analyze indicators to determine their relevance, context, and potential impact.|
|**5. Dissemination**|Share validated indicators with relevant stakeholders (e.g., SOC, SIEM, partners).|
|**6. Use / Action**|Deploy indicators in security tools for detection, alerting, blocking, or investigation.|
|**7. Feedback & Evaluation**|Monitor the effectiveness of indicators and collect feedback to improve accuracy and value.|
|**8. Retirement / Expiration**|Remove or archive outdated, false-positive, or no longer relevant indicators.|




### 📌 Example Indicator Life Cycle (for a malicious IP address):

1. **Planning:** Need to detect C2 servers used by phishing campaigns.
2. **Collection:** Malicious IP found in sandboxed malware analysis.
3. **Processing:** Extract IP and timestamp from PCAP file.
4. **Analysis:** Determine IP is associated with known APT campaign.
5. **Dissemination:** Share in threat feed and internal SIEM.
6. **Use:** Block IP at firewall and set alert in SIEM.
7. **Feedback:** Analysts report frequent false positives.
8. **Retirement:** IP is removed after campaign ends and reputation improves.


### ✅ **Why It Matters**

The Indicator Life Cycle ensures indicators:

- Stay **relevant and timely**.
- Are **used effectively** in security operations.
- Are **retired properly** to avoid clutter and reduce false positives.

#### **مقدمة دورة حياة المؤشر (Indicator Life Cycle):**

تخيل أنه تم إعلامك بأن أحد عناوين الـ IP في منظمتك يتواصل مع عنوان IP مشبوه معروف بنشاطاته الضارة مثل التحكم والسيطرة (C2). الهدف الآن هو استخدام هذه المعلومة البسيطة للبحث عن أي نشاط ضار محتمل. وهنا يأتي دور نموذج **دورة حياة المؤشر**.

**دورة حياة المؤشر** تشرح كيف تنشأ المؤشرات (Indicators) من المعلومات الاستخباراتية، وتتحرك بين مراحل مختلفة (كشف، تحليل، استخدام...) بمساعدة أشخاص، عمليات، وتقنيات. يتم تمثيل هذه الدورة أحيانًا كمخطط يُظهر الحالات والتحولات بينها.

---

#### **المراحل الأساسية لدورة الحياة:**

1. **Revealed (المكشوف):**
    - عندما يُكشف عن مؤشر (مثل عنوان IP ضار) من مصادر داخلية أو خارجية.
    - قد يكون داخليًا من تحليل داخلي أو خارجيًا من شراكات ومصادر مشاركة استخبارات (مثل ISAC).
2. **Vetted (التمحيص):**
    - يتم تقييم المؤشر من حيث الجودة، الدقة، والقدرة على استخدامه في البيئة الحالية.
    - الهدف هو معرفة ما إذا كان هذا المؤشر يعكس نشاطاً ضارًا حقيقيًا.
3. **Mature (النضج):**
    - إذا تم التحقق من المؤشر وصلاحيته للاستخدام في اتخاذ إجراءات (اكتشاف أو منع).
    - يتم تصنيفه على أنه ناضج وجاهز للتنفيذ.
4. **Utilized (الاستخدام):**
    - عندما يُستخدم المؤشر فعليًا في إجراء ما، مثل كشف هجوم أو منعه.
    - يؤدي هذا إلى اكتشاف مؤشرات جديدة، وبالتالي إعادة بدء الدورة مرة أخرى.


Key Indicators
Arguably, the most important characteristics of a campaign are its key indicators. Key indicators are those that meet all the following criteria:
- Remain consistent across multiple intrusions.
- Uniquely distinguish a campaign from other campaigns.
- Distinguish a campaign from benign activity.
- Align to a single category of adversary action (such as Exploitation).



### **الفقرة الأولى – Discovery and Indicator Life Span (اكتشاف وطول عمر المؤشر):**

المؤشرات الاستخباراتية لها عمر استخدام يختلف حسب سلوك العدو، وليس حسب نوع المؤشر نفسه. فبعض المؤشرات مثل عناوين الـ IP قد تكون عديمة الفائدة خلال ساعات إذا تم تغييرها سريعًا، بينما قد تستمر مؤشرات أخرى لسنوات إذا ظلت البنية التحتية للعدو ثابتة. قاعدة عامة: كلما كان المؤشر أقرب لنشاط العدو، كان أكثر استقرارًا وأهمية. من المهم عدم حذف المؤشرات لمجرد أنها قديمة، بل الاحتفاظ بها حتى تسبب ضغطًا أو مشاكل في النظام، ثم تحسين طريقة إدارتها.

---

### **الفقرة الثانية – Indicator Fatigue and Proper Use Cases (إرهاق المؤشرات وكيفية استخدامها):**

إرهاق المحللين نتيجة عدد كبير من التنبيهات والمؤشرات يُعد مشكلة شائعة، حيث يصعب التعامل مع آلاف التنبيهات يوميًا. المؤشرات لا ينبغي اعتبارها أدوات كشف رئيسية، بل يجب استخدامها لتوسيع الفهم حول الهجمات السابقة. أفضل قيمة لها تظهر عندما يتم إنتاجها داخليًا وتخص بيئة المؤسسة نفسها، لأن أغلب المؤشرات لا تكون فعالة عند مشاركتها بين جهات مختلفة. أدوات مثل SIEM يمكن أن تضيف سياقًا للمؤشرات، لكنها قد تؤدي لنتائج خاطئة إذا أُسيء استخدامها. القيمة الحقيقية للمؤشرات تكمن في سد الثغرات المعرفية حول سلوك العدو.





**مقياس الانزلاق للأمن السيبراني (Sliding Scale of Cyber Security)**  
هو إطار نظري طوره **روبرت إم. لي (Robert M. Lee)** لتبسيط وفهم الأنشطة المختلفة التي تُسهم في الأمن السيبراني بدون الحاجة للدخول في تفاصيل تقنية معقدة. الهدف منه هو توجيه التفكير وليس تقديم نموذج تطبيقي محدد.

المقياس يتكون من خمس مراحل مرتبة من الأضعف إلى الأقوى أو من الدفاعي إلى الهجومي:

---

#### 1. **الهندسة (Architecture)**

- تتعلق ببناء بيئة تقنية آمنة من الأساس.
    
- تشمل: سلسلة الإمداد، هيكلة الشبكة، الصيانة والتحديثات.
    
- هي المرحلة التي لا تشمل تفاعلًا مباشرًا مع الهجمات بل تهيئة البنية للوقاية.
    

---

#### 2. **الدفاع السلبي (Passive Defense)**

- يوفر حماية مستمرة دون تدخل بشري دائم.
    
- يشمل: الجدران النارية (firewalls)، أنظمة كشف التسلل (IPS)، مضادات الفيروسات (AV)، وغيرها.
    
- يهدف إلى منع أو تقليل تأثير الهجمات بشكل تلقائي.
    

---

#### 3. **الدفاع النشط (Active Defense)**

- هنا يبدأ التفاعل البشري.
    
- يقوم المحللون بمراقبة الشبكة، تحليل سلوك التهديدات، والاستجابة لها داخليًا.
    
- الهدف هو التعلم من الهجمات والرد عليها بفعالية.
    

---

#### 4. **الاستخبارات (Intelligence)**

- جمع البيانات وتحويلها إلى معلومات ذات معنى، ثم إنتاج استخبارات تهديدات.
    
- يمكن أن تكون البيانات داخلية (مثل تحليل سلسلة القتل أو نموذج الماس) أو خارجية (مثل مراقبة أنشطة المخترقين).
    
- تُستخدم هذه الاستخبارات لاحقًا في الدفاع النشط.
    

---

#### 5. **الهجوم (Offense)**

- يشمل الإجراءات القانونية أو التقنية المضادة ضد المهاجمين مثل:
    
    - الرد القانوني،
        
    - الهجوم العكسي (hack-back).
        
- يتم فقط ضمن أطر قانونية وسياسية واضحة.
    

---

The Sliding Scale of Cyber Security is a theoretical framework by Robert M. Lee that categorizes cybersecurity efforts into five progressive areas: **Architecture**, **Passive Defense**, **Active Defense**, **Intelligence**, and **Offense**. It aims to help frame cybersecurity discussions without overly technical detail. Starting with strong foundational design (Architecture) and automated protections (Passive Defense), it moves to human-driven responses (Active Defense), the production and use of threat intelligence (Intelligence), and finally legal or offensive countermeasures (Offense). The model emphasizes a balanced, context-driven approach to cybersecurity.



#### الاستثمار والعائد (ROI):

- الجانب الأيمن من المقياس (الاستخبارات والهجوم) غالباً ما يكون **أعلى تكلفة**، لكنه يوفر **معلومات قيمة** يمكن استخدامها لتحسين الدفاعات على الجانب الأيسر.
    
- باستخدام هذه الدروس، يمكن تطبيق تغييرات تؤدي إلى **زيادة العائد على الاستثمار (ROI)** عبر تقليل الهجمات أو تقليص أثرها.



**Leverage Intelligence to Drive Value** emphasizes using threat intelligence not just for immediate defense, but to create lasting improvements in security posture. Intelligence teams should push organizations to apply lessons from adversary engagements to the left side of the sliding scale—improving architecture, tuning passive defenses, and sharpening active defenders. Although intelligence and offense are more costly, they offer critical insights that, when applied correctly, result in a higher return on investment (ROI). Ultimately, well-integrated intelligence and defense functions enable organizations to stay ahead of threats and maximize security value.



بالتأكيد، إليك الشرح المفصل للمفاهيم الواردة في الصور بالنقاط باللغة العربية، متبوعًا بملخص موجز بالإنجليزية.

---

### **الشرح باللغة العربية:**

**1. توليد الذكاء مقابل استهلاكه (Intelligence Generation vs. Consumption)**
*   **التوليد (Generation)** هو عملية *إنشاء* الذكاء الاصطناعي. هذا يشمل جمع البيانات وتحليلها باستخدام نماذج مثل دورة حياة الذكاء (Intelligence Life Cycle) وسلسلة القتل الإلكتروني (Cyber Kill Chain) ونموذج الماس (Diamond Model) لفهم تهديدات معادية وحملاتها.
*   **الاستهلاك (Consumption)** هو عملية *استخدام* ذلك الذكاء المُنشأ لتحسين الدفاعات. يتم ذلك عن طريق إدخال المؤشرات (IOCs) في أنظمة دفاع سلبية (مثل الجدران النارية وبرامج مكافحة الفيروسات) أو استخدامه من قبل فرق الدفاع النشط (مثل فرق الاستجابة للحوادث ومحللي البرامج الضارة).
*   العلاقة بينهما **ثنائية الاتجاه**: فريق الاستهلاك (مثل المستجيبين للحوادث) هم مصدر رئيسي للبيانات التي تُستخدم لاحقًا في توليد ذكاء جديد.

**2. المقياس المنزلق للأمن السيبراني (The Sliding Scale of Cyber Security)**
*   هو إطار نظري طوره "روبرت إم لي" لتبسيط مناقشة الأنشطة الأمنية دون الدخول في تفاصيل تقنية معقدة.
*   يهدف إلى تصنيف الإجراءات الدفاعية إلى مراحل متعددة بدلاً من مجرد تقسيمها إلى "هجوم" و"دفاع".
*   **توليد الذكاء يقع ضمن مرحلة "الذكاء" (Intelligence)** في هذا المقياس.
*   **استهلاك الذكاء يقع ضمن مرحلة "الدفاع النشط" (Active Defense)** في هذا المقياس.

**3. الاستفادة من الذكاء لخلق قيمة (Leverage Intelligence to Drive Value)**
*   الهدف النهائي من استهلاك الذكاء هو **إحداث تغيير إيجابي** في المؤسسة.
*   يجب أن تركز الفرق على استخدام الدروس المستفادة من كل مواجهة مع الخصم لتحسين البنية التحتية (Architecture) والدفاعات السلبية (Passive Defenses) ومهارات المدافعين النشطين (Active Defenders) على المدى الطويل.
*   يجب على المختصين قياس **العائد على الاستثمار (ROI)** لأي إجراء أمني لتعظيم القيمة التي تقدمها عمليات الذكاء.

**4. استهلاك الذكاء في المراحل المختلفة (كيف نستخدم الذكاء في كل مرحلة):**
    *   **الهجوم (Offense)**: الذكاء ضروري للتخطيط للعمليات الهجومية (نادرة في القطاع الخاص) لاستهداف العدو الصحيح وتجنب الأضرار الجانبية. غالبًا ما يكون العائد على الاستثمار ضعيفًا.
    *   **الذكاء (Intelligence)**: يمكن استخدام الذكاء المستهلك لتحسين عمليات الذكاء ذاتها، مثل جعل فرق المحاكاة (Red Teams) تحاكي تكتيكات العدو الحقيقية وليس فقط أحدث الأدوات. كما يساعد في توليد فرضيات للبحث عن التهديدات (Threat Hunting) وإعادة هيكلة الفرق لمواجهة التهديدات بشكل أفضل.
    *   **الدفاع النشط (Active Defense)**: هذا هو المحور الرئيسي لمعظم الفرق. يُقصد به **المكون البشري** الذي يطارد التهديدات ويتصدى لها. يجب أن يقود الذكاء كيفية القيام بالاستجابة للحوادث (IR) والمراقبة الأمنية للشبكة (NSM) وصيد التهديدات (Threat Hunting).
    *   **الدفاع السلبي (Passive Defense)**: استخدام الذكاء لجعل الأدوات الآلية (مثل مضادات الفيروسات، أنظمة كشف الاختراق IPS/IDS) أكثر ذكاءً وتكيفًا. هذا يحرر فرق الدفاع النشط (البشر) للتركيز على التهديدات الأكثر تعقيدًا بدلاً من معالجة كل مشكلة صغيرة.
    *   **الهندسة المعمارية (Architecture)**: استخدام الذكاء لتحسين **تصميم** الأنظمة والشبكات وجعلها **أكثر قابلية للدفاع** عنها منذ البداية. يساعد الذكاء في تحديد الثغرات الأكثر خطورة والتي يستغلها الخصم بالفعل، مما يساعد في تحديد أولويات التصحيح.

---

### **English Summary (In Brief Paragraphs):**

**1. Intelligence Generation vs. Consumption:**
Intelligence generation is the process of creating threat intelligence through analysis and models like the Kill Chain. Intelligence consumption is the act of using that generated intelligence to improve security defenses, either by feeding it into automated tools or using it to guide human-led security actions. These two functions are distinct but feed into each other in a continuous cycle.

**2. The Sliding Scale of Cyber Security:**
This framework categorizes cybersecurity activities. Generating intelligence falls into the "Intelligence" category. Using that intelligence to drive defense, known as "actuating intelligence," primarily falls under the "Active Defense" category on the scale.

**3. Driving Value with Intelligence:**
The ultimate goal of consuming intelligence is to drive positive organizational change. Lessons learned from engagements should be used to improve future architectures, defenses, and processes, maximizing the return on investment (ROI) for security efforts.

**4. Intelligence Consumption Across the Scale:**
*   **Offense:** Intelligence is crucial for planning targeted offensive actions, though these are rare and often have poor ROI for most organizations.
*   **Intelligence:** Intelligence can be consumed to improve other intelligence acts, such as making Red Team exercises more realistic based on real adversary behavior and generating hypotheses for threat hunting.
*   **Active Defense:** This is the human element of defense. Intelligence directly drives how teams perform threat hunting, incident response, and security monitoring.
*   **Passive Defense:** Intelligence is used to tune and improve automated tools (like firewalls and IPS), making them more adaptive and freeing up human analysts to focus on complex threats.
*   **Architecture:** Intelligence informs the design of systems and networks to make them more defensible. It helps prioritize patching vulnerabilities that are actively being exploited by relevant threats.



The Four Types of Detection : configuration analysis, modeling, indicators, and threat behaviors.



# Preparing the Team to generate Intelligence


# Planning and Direction

بالتأكيد، إليك الشرح المفصل للمفاهيم الواردة في الصور الجديدة، مع التكامل مع المفاهيم السابقة.

---

### **الشرح باللغة العربية:**

**1. التخطيط: إطار إدارة الجمع (Planning: Collection Management Framework - CMF)**

*   **ما هو؟** إطار إدارة الجمع (CMF) هو **خطة استراتيجية** توضح **كيف** و**من أين** و**أي نوع** من البيانات سوف تجمعها فرق الذكاء الخاص بك.
*   **لماذا هو مهم؟**
    *   هو **الرابط الأساسي بين المتطلبات والبيانات**. قبل أن تحاول الإجابة على متطلباتك الاستخباراتية (IRs)، يجب أن تسأل: "هل لدى بياناتي اللازمة للإجابة على هذا السؤال؟"
    *   **يحدد الإمكانيات والقيود**: يساعدك الـ CMF على فهم الأسئلة التي *يمكنك* الإجابة عليها بناءً على البيانات المتاحة لك، والأسئلة التي *لا يمكنك* الإجابة عليها بسبب فجوات في جمع البيانات.
    *   **يمنع إضاعة الوقت والموارد**: بدلاً من محاولة تحقيق متطلبات استخباراتية مستحيلة (مثل تتبع intrusions حدثت منذ 3 أشهر بينما لديك بيانات من شهرين فقط)، يساعدك الـ CMF على تحديد هذه الثغرات والعمل على سدها في المستقبل.
*   **مثال على القيود**: إذا طلب منك المدراء التنفيذيون "نسب" هجوم إلى مجموعة تهديد معينة (Attribution)، ولكن ليس لديك أي بيانات من داخل شبكتك عن هذه المجموعة أو خبرة مباشرة معها، فإن هذا المطلب سيكون مستحيلاً تحقيقه بثقة. الـ CMF يجعل هذه الحقيقة واضحة منذ البداية.

**2. نموذج لإطار إدارة الجمع (خاص ببيانات البرامج الضارة)**

*   يوضح هذا المثال العملي كيفية بناء خطة جمع ملموسة، في هذه الحالة للبيانات المتعلقة بالبرامج الضارة (Malware).
*   **خطوات بناء خطة الجمع:**
    1.  **تحديد احتياجاتك المعلوماتية (Determine Information Needs)**: بناءً على "ماذا يمكنك أن تفعل" بالبيانات؟ (مثل: هل يمكنك عمل alert للـ IPs أو Hashes؟ هل تحتاج معلومات إضافية (Enrichment) لفهم التهديد عند ظهور alert؟).
    2.  **تحديد مصادر التهديد (Identify Threat Feeds)**: البحث عن المصادر الخارجية (مثل Threat Intelligence Feeds) التي توفر نوع البيانات التي تحتاجها. ليس فقط نوع المؤشر (IP, Hash...) ولكن **مصدر هذا البيانات** مهم جداً (مثلاً: هل هذا المصدر يجمع بيانات من قطاع финансовي بينما أنت في قطاع صحي؟ قد لا تكون البيانات ذات صلة بك).
*   **الخلاصة**: خطة الجمع الجيدة تضمن أن البيانات التي تجمعها **قابلة للتنفيذ** و**ذات صلة** باحتياجاتك التنظيمية وقدراتك الدفاعية، مما يحقق أقصى استفادة من الذكاء المستهلك.

---

### **التكامل مع المفاهيم السابقة:**

*   يرتبط **إطار إدارة الجمع (CMF)** ارتباطًا وثيقًا بمرحلة **توليد الذكاء (Intelligence Generation)**. فلا يمكنك توليد ذكاء ذي قيمة بدون بيانات خام عالية الجودة وذات صلة، والـ CMF هو الذي يضمن حصولك على هذه البيانات.
*   يعد الـ CMF جزءًا أساسيًا من **دورة حياة الذكاء (Intelligence Life Cycle)**، وتحديداً في مرحلة **التوجيه (Direction)** و**الجمع (Collection)**.
*   جودة **الذكاء المُستهلك** في الدفاع النشط والسلبي (Active/Passive Defense) تعتمد بشكل مباشر على جودة **الذكاء المُولَّد**، والتي بدورها تعتمد على فعالية **إطار إدارة الجمع (CMF)**. إذا كانت خطة الجمع ضعيفة، سيكون الذكاء ضعيفاً، وبالتالي ستكون دفاعاتك أقل فاعلية.

---

### **English Summary (In Brief Paragraphs):**

**1. Planning: Collection Management Framework (CMF)**
A Collection Management Framework (CMF) is a crucial plan that defines what data to collect, where to collect it from, and how. It acts as the bridge between intelligence requirements (IRs) and available data. Before attempting to answer an IR, analysts must use the CMF to assess if it's even feasible with their current data sources. This prevents wasted effort on impossible tasks and helps identify critical data gaps that need to be filled for future success.

**2. A Sample CMF for Malware Data**
This example shows how to build a practical collection plan. The process starts by determining actionable information needs (e.g., indicators for alerting, enrichment data). Then, relevant threat feeds that provide this specific data must be identified, paying close attention to the original source and context of the data to ensure its relevance and quality. A good CMF ensures the collected data is useful and actionable for the organization.


The Vocabulary for Event Recording and Incident Sharing (VERIS)
Captures metrics on events and incidents
Strategic-level counterpart to indicator sharing
Most well-known use case is the Verizon Data
Breach Investigations Report (DBIR)

بالتأكيد، إليك الشرح المفصل للمفاهيم الواردة في الصور الخاصة بـ VERIS، مع التكامل مع المفاهيم السابقة.

---

### **الشرح باللغة العربية:**

**أساسيات إطار VERIS (Vocabulary for Event Recording and Incident Sharing)**

*   **ما هو VERIS؟** هو إطار عمل (إطار تصنيف) قياسي **لتوثيق حوادث الأمان السيبراني** بطريقة منهجية وقابلة للقياس. فكر فيه كلغة مشتركة لوصف الحوادث.
*   **الهدف الرئيسي:** تحويل وصف الحوادث من قصص نصية غير منظمة إلى **بيانات منظمة** يمكن تحليلها إحصائياً لفهم الاتجاهات (Trends) والأنماط (Patterns) في بيئتك.
*   **البساطة والمرونة:** يمكنك البدء بمجموعة أساسية جداً من المعلومات (مثل التاريخ، رقم الحادث) ثم إضافة التفاصيل لاحقاً حسب الحاجة.

**المكونات الأساسية: الـ 4A's (الأركان الأربعة لكل حادث)**

يقسم VERIS أي حادث أمني إلى أربعة مكونات رئيسية، هي:

1.  **الإجراء (Action): "كيف حدث الحادث؟"**
    *   هذا الصنف يصف **الطريقة أو التقنية** التي استخدمت لحدوث الحادث.
    *   **الأنواع الأساسية للإجراءات:**
        *   **برامج ضارة (Malware):** كافة أنواع البرمجيات الخبيثة.
        *   **اختراق (Hacking):** استغلال الثغرات أو الوصول غير المصرح به.
        *   **هندسة اجتماعية (Social):** التصيد (Phishing) أو الخداع.
        *   **إساءة استخدام (Misuse):** إساءة استخدام صلاحيات موجودة من قبل (موظف داخلي مثلاً).
        *   **مادي (Physical):** الوصول المادي (مثل سرقة جهاز أو استخدام USB).
        *   **خطأ (Error):** أخطاء في التكوين أو البرمجيات.
        *   **بيئي (Environmental):** كوارث طبيعية أو عواصف.

2.  **الأصل/الأصل (Asset): "ماذا تأثر؟"**
    *   يحدد **ما هو المورد** الذي تم استهدافه أو تأثره بالحادث.
    *   **يمكن أن يشمل:** خوادم، أجهزة كمبيوتر محمولة، أجهزة شبكة، بيانات، تطبيقات، إلخ.
    *   **يُسجل أيضاً:** من يملك الأصل (الشركة، موظف، عميل) ومن يديره (داخلي، طرف خارجي).

3.  **الفاعل (Actor): "من قام به؟"**
    *   يصف **الكيان أو الشخص** الذي قام بالعمل (دون افتراض نية خبيثة دائمًا).
    *   **التصنيف الأساسي للفاعل:**
        *   **داخلي (Internal):** موظف.
        *   **خارجي (External):** مخترق من خارج المنظمة.
        *   **شريك (Partner):** مقاول أو طرف ثالث له صلاحية وصول.
        *   **غير معروف (Unknown).**
    *   **يمكن إضافة تفاصيل مثل:** الدافع (تجسس، مالي، أيديولوجي) ونوع الفاعل (منافس، مجرم إلكتروني، إلخ).

4.  **السمة/الأثر (Attribute): "ما هو التأثير؟"**
    *   يصف **كيف تأثر الأصل** من حيث أهداف الأمان الأساسية (نموذج CIA).
    *   **يتبع نموذج CIA:**
        *   **السرية (Confidentiality):** هل تمت سرقة أو الاطلاع على بيانات؟
        *   **النزاهة (Integrity):** هل تم تعديل أو تغيير البيانات؟
        *   **التوافر (Availability):** هل تم تعطيل الخدمة أو النظام؟
    *   يساعد هذا في **قياس الأثر** المادي أو التشغيلي للحادث.

**مستويات التسجيل:**
لكل حقل من الحقول السابقة، يمكنك التسجيل بمستويين:
1.  **مستوى أساسي (نعم/لا):** للإشارة إلى وجود النشاط في هذا الصنف فقط.
2.  **مستوى مفصل (باستخدام التعدادات):** لتسجيل تفاصيل إضافية (مثل نوع البرنامج الضار المحدد، كيفية الاختراق، نوع البيانات المسربة، إلخ).

**فوائد استخدام VERIS:**
*   **التحليل الداخلي:** تتبع اتجاهات التهديدات داخل مؤسستك وتحسين الدفاعات بناءً على بيانات فعلية.
*   **المشاركة الخارجية:** تبادل المعلومات مع الآخرين بطريقة قياسية وموحدة (مثل المساهمة في تقارير صناعية كبيرة مثل الـ DBIR) دون الكشف عن معلومات حساسة.
*   **اتخاذ قرارات أفضل:** تحويل الأمان من ردود أفعال إلى عملية قائمة على البيانات.

---

### **التكامل مع المفاهيم السابقة:**

*   يعد **VERIS** أداة عملية حاسمة في مرحلة **توليد الذكاء (Intelligence Generation)**. فهو الإطار الذي يُستخدم **لتحويل بيانات الحادث الخام (Raw Incident Data)** التي يجمعها فريق الاستجابة للحوادث (الاستهلاك) إلى **ذكاء منظم** يمكن تحليله.
*   يعتمد إنشاء **إطار إدارة الجمع (CMF)** فعال على فهم ما تحتاج إلى جمعه. يوفر VERIS **الهيكل (Schema)** الذي يحدد بالضبط أنواع بيانات الحوادث التي يجب جمعها (الـ 4A's) لضمان اكتمالها وفائدتها.
*   **الذكاء المُستهلك** في تحسين الهندسة المعمارية (Architecture) والدفاع النشط (Active Defense) (مثل: أي ثغرات يتم استغلالها؟ أي تكتيكات تُستخدم؟ أي أصول تُستهدف؟) يأتي مباشرة من تحليل البيانات المسجلة بواسطة VERIS.

---

### **English Summary (In Brief Paragraphs):**

**1. Fundamentals of VERIS:**
VERIS is a standardized framework for recording security incidents in a structured and measurable way. It uses a common vocabulary based on the "4 A's" to break down any incident: **Action** (how it happened, e.g., malware, hacking), **Asset** (what was affected, e.g., server, data), **Actor** (who did it, e.g., internal, external), and **Attribute** (the impact, i.e., on Confidentiality, Integrity, or Availability). This moves incident description from narrative to data.

**2. Recording and Benefits:**
For each category, you can record a simple yes/no or provide detailed enumerations. Using VERIS transforms raw incident data into analyzable information. This allows for internal trend analysis, improves strategic decision-making, and enables standardized, anonymized information sharing with the community (e.g., for reports like the DBIR), turning cybersecurity from reactive to data-driven.

بالتأكيد، إليك الشرح المفصل للمفهوم الجديد (VCAF) مع التكامل مع ما سبق.

---

### **الشرح باللغة العربية:**

**VCAF - إطار الهجوم المشترك لـ VERIS (VERIS Common Attack Framework)**

*   **ما هو VCAF؟** هو **امتداد (Extension)** لإطار VERIS الأساسي، تم تطويره لسد فجوة فيه. وهو يجمع بين قوة **VERIS** في تصنيف الحوادث (الـ 4A's) وقوة إطار **MITRE ATT&CK** في وصف التكتيكات والتقنيات التفصيلية للهجوم.

*   **لماذا تم تطويره؟**
    1.  **قصور في VERIS:** إطار VERIS الأصلي لم يكن مصمماً لتسجيل **كافة التفاصيل التقنية الدقيقة** للهجمات بشكل يدعم جميع حالات الاستخدام المحتملة.
    2.  **وجود إطار أفضل:** إطار MITRE ATT&CK أصبح معياراً صناعياً واسع الانتشار لوصف سلوكيات ومناورات المهاجمين بتفصيل غير مسبوق.
    3.  **توسيع نطاق الرؤية:** فريق تقرير DBIR أدرك أن البيانات التي كانوا يجمعونها عن الحوادث كانت محدودة للغاية وتركز فقط على المناطق التي تكون الرؤية فيها عالية لفريق الاستجابة للحوادث (مثل وجود برامج ضارة أو استغلال ثغرات واضحة). بينما كانوا يفتقدون الكثير من التفاصيل التقنية والسياق.

*   **أهداف وفوائد VCAF:**
    *   **فهم أعمق للتفاصيل التقنية:** ربط الحادث المسجل في VERIS بالتكتيكات والتقنيات المحددة في MITRE ATT&CK التي استخدمها المهاجم.
    *   **تحسين أولوية المعالجة:** لا يتم تحديد أولويات المعالجة (Mitigations) بناءً على أنواع الحوادث العامة فقط (مثل "هجوم اختراق")، ولكن بناءً على **التقنيات الدقيقة** التي تم استخدامها عبر *جميع* أنواع الحوادث (بما في ذلك تلك الناتجة عن خطأ أو إساءة استخدام).
    *   **فهم أفضل للقدرات والاستهداف:** فهم العلاقة بين قدرات المهاجم (التقنيات التي يستخدمها) وكيفية استهدافه للمؤسسة.
    *   **التقاط السياق الكامل للحادث:** الذهاب beyond مجرد القطع الأثرية التقنية (Technical Artifacts) مثل الـ IPs و Hashes لفهم سياق الحادث بشكل أوسع.
    *   **تسهيل التواصل:** استخدام إطار موحد ومفاهيم معروفة (مثل تسميات MITRE ATT&CK) يسهل التواصل حول مفاهيم الأمن السيبراني حتى مع غير المختصين.

---

### **التكامل مع المفاهيم السابقة:**

*   **VCAF هو الجسر بين المستويات:** يمثل VCAF التطور الطبيعي الذي يربط بين:
    1.  **التصنيف العام للحوادث** على مستوى عالٍ (بواسطة VERIS) الذي يناسب الإدارة والتقارير الاستراتيجية.
    2.  **التفاصيل التكتيكية والتقنية** العميقة (بواسطة MITRE ATT&CK) التي تعتبر **الوقود** لعملية **توليد الذكاء (Intelligence Generation)** وهي الأساس الذي تُبنى عليه **عمليات الدفاع النشط (Active Defense)** مثل صيد التهديدات (Threat Hunting).

*   **يعزز قيمة الذكاء المُستهلك:** عندما يتم ربط حادث ما بتقنيات ATT&CK محددة عبر VCAF، فإن هذا يثري **الذكاء المُولد** بشكل هائل. هذا الذكاء الغني والمفصل يمكن بعد ذلك **استهلاكه** بشكل أكثر فعالية ل:
    *   **تحسين الدفاعات السلبية (Passive Defense):** ضمان أن أنظمة الـ IDS/IPS تبحث عن أنماط الهجوم الصحيحة.
    *   **توجيه الدفاع النشط (Active Defense):**告诉 فرق صيد التهديدات بالضبط ما الذي يجب أن يبحثوا عنه (بناءً على التقنيات التي شوهدت من قبل).
    *   **تحسين الهندسة المعمارية (Architecture):** تحديد الثغرات في البنية التحتية التي تسمح بتقنيات هجومية معينة ومعالجتها.

*   **يكمل إطار إدارة الجمع (CMF):** يوضح VCAF *نوع* التفاصيل التقنية العميقة التي يجب أن يسعى الـ CMF إلى جمعها من حوادث المستقبل.

---

### **English Summary (In Brief Paragraphs):**

**VCAF - VERIS Common Attack Framework:**
The VCAF is an extension to the VERIS framework designed to address its limitation in capturing nuanced technical attack details. It integrates MITRE ATT&CK's detailed tactics and techniques into VERIS's incident classification structure. This merger aims to move beyond limited data collection by providing deeper technical insights into incidents, enabling better mitigation prioritization based on specific techniques used across all incident types (not just malware or hacking), and improving the understanding of adversary capabilities and targeting. Ultimately, it helps capture fuller incident context and simplifies communication of complex cybersecurity concepts.


----


1- Cyber Kill chain
2- Diamond Model

## The Courses of Action Matrix (COA) framework

The Courses of Action (CoA) Matrix is a powerful tool for moving from simply understanding a threat to actively planning how to defeat it.
Let's break down the matrix in detail, expanding on your accurate description.

**Core Concept: Bridging Analysis and Action :**

The CoA Matrix is a structured framework designed to help defenders systematically plan and coordinate their defensive measures against a specific threat, as defined by its **Tactics, Techniques, and Procedures (TTPs)** within the **Cyber Kill Chain** framework.

Its primary purpose is to ensure that for every phase of an adversary's attack, the defense team has considered and prepared a range of potential responses. It turns intelligence into actionable defense.


**Detailed Breakdown of the Components :**

 1. The Rows: The Cyber Kill Chain Phases
The Kill Chain describes the sequential steps an adversary must complete to achieve their objective. By breaking the attack into phases, defenders can identify opportunities to stop it early. The standard Lockheed Martin Kill Chain phases are:
*   **Reconnaissance:** The attacker researches and identifies targets (e.g., scanning for vulnerabilities, harvesting employee emails).
*   **Weaponization:** Coupling a payload (e.g., malware) with an exploit into a deliverable weapon (e.g., a malicious PDF document).
*   **Delivery:** Transmitting the weapon to the target (e.g., via phishing email, malicious website, USB drop).
*   **Exploitation:** The code is executed, exploiting a vulnerability in the target system.
*   **Installation:** The malware installs a persistent backdoor or command-and-control (C2) mechanism on the target.
*   **Command & Control (C2):** The compromised system establishes a connection to the attacker's server for ongoing control.
*   **Actions on Objectives:** The attacker achieves their goal (e.g., data exfiltration, encryption for ransom, destruction of systems).

#### 2. The Columns: The Courses of Action (The "7 Ds")
These are the categorical types of defensive actions a team can take. They are often listed in order of preference, with "Discover" and "Detect" being the most passive and "Destroy" being the most extreme.

| Course of Action | Definition & Goal                                                                                                                                                                     | Example Activities                                                                                                                                                    |
| :--------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Discover**     | **Find existing compromises.** Proactively hunting for IOCs and TTPs that indicate a past or ongoing breach.                                                                          | • Forensic disk analysis<br>• Memory analysis<br>• Log analysis for previously unknown IOCs<br>• Threat hunting campaigns                                             |
| **Detect**       | **Identify malicious activity as it happens.** The goal is to generate an alert for investigation.                                                                                    | • Deploying IDS/IPS signatures<br>• Tuning SIEM rules for specific TTPs<br>• Configuring EDR to alert on specific processes<br>• Email gateway filtering              |
| **Deny**         | **Prevent an action from succeeding.** This is about blocking access and enforcing "default deny" policies.                                                                           | • Network segmentation / Firewalls<br>• Application whitelisting<br>• Strict file & folder permissions<br>• Disabling unnecessary services or ports                   |
| **Disrupt**      | **Stop an ongoing attack or C2 communication.** This is an active intervention against a live threat.                                                                                 | • Sinkholing a malicious domain<br>• Blocking C2 IP addresses at the firewall<br>• Isolating a compromised host from the network<br>• Terminating malicious processes |
| **Degrade**      | **Reduce the effectiveness of the attack.** Make it harder, slower, or more costly for the adversary to operate.                                                                      | • Implementing rate-limiting on network connections<br>• Adding complexity to authentication processes<br>• Using traffic shaping to slow exfiltration                |
| **Deceive**      | **Mislead and confuse the adversary.** Feed them false information and waste their time.                                                                                              | • Deploying honeypots & honeytokens<br>• Network deception platforms<br>• Providing false documents or credentials                                                    |
| **Destroy**      | **Offensive countermeasures.** Actively attacking the adversary's infrastructure. **Note:** This is typically only legal for military or government agencies with specific authority. | • Taking down attacker C2 servers (via legal means)<br>• Deploying malware against the attacker (a "counter-strike")                                                  |

#### 3. The Cells: Populating the Matrix
This is where the work happens. For a specific threat (e.g., "FIN7 phishing campaign" or "Cobalt Strike Beacon deployment"), you:
1.  **Analyze its TTPs:** How does it operate at each Kill Chain phase?
2.  **Brainstorm Defenses:** For each phase (row), what actions can we take in each category (column)?
3.  **Populate the Cell:** The cell content is the specific **indicator (IOC)** or **defensive measure (TTP)** you will use.


### Example: Populating a Cell for a Ransomware Attack

Let's take the **Delivery** phase, where the adversary uses a **Phishing Email with a malicious ZIP attachment**.

| Kill Chain Phase | **Discover** | **Detect** | **Deny** | **Disrupt** | **Degrade** | **Deceive** | **Destroy** |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **...** | | | | | | | |
| **Delivery** | *Hunt for emails with the subject "Invoice #INV-98452" sent in the last 30 days.* | *SIEM rule to alert on emails with the attachment `*.scr` or `*.js`.* | *Block all emails with `.zip` attachments at the gateway.* | *Quarantine all received emails matching the known IOC subject line.* | *Automatically flag external emails with attachments for manual review.* | *Honeytoken email account to receive phishing attempts.* | *N/A (Not typically used by corporate defenders)* |
| **...** | | | | | | | |

### Strategic Value and Benefits

1.  **Comprehensive Planning:** Forces defenders to think beyond just detection and blocking. It encourages creative solutions like deception and degradation.
2.  **Clear Communication:** Provides a common language and framework for both technical staff and management to discuss defense options and their outcomes.
3.  **Measurable Improvement:** The matrix makes gaps in defenses glaringly obvious. If you have no actions for "Disrupt" or "Deceive," you know where to focus your efforts.
4.  **Proactive Posture:** Shifts the mindset from reactive (waiting for alerts) to proactive (hunting, denying, deceiving).
5.  **Resource Allocation:** Helps prioritize which security controls to implement or purchase based on the threats that matter most to your organization.

### Limitations

*   **Static Snapshot:** The matrix is based on known TTPs. It must be continuously updated as threats evolve.
*   **Can Be Complex:** Building a complete matrix for multiple threats is time-consuming.
*   **Theoretical vs. Practical:** Some actions in the cells may not be feasible due to technical, financial, or legal constraints.

In summary, the Courses of Action Matrix is an essential tool in the threat intelligence practitioner's toolkit. It operationalizes intelligence by providing a clear, structured method to plan, document, and communicate how an organization will defend itself against specific cyber threats.



---


# Section 3 : Collection source 


---- [Search about : HEXANE DanBot - Glass Rat  && Video about : maltego]


### Threat Intelligence Quotient (TIQ)

The TIQ Test can be used to get an idea of the value of existing threat feeds you are using by evaluating the following:
- Novelty Test
- Overlap Test
- Population Test
	- by Country
	- by ASN

### Collective Intelligence Framework (CIF) 
Collective Intelligence Framework (CIF)  is a management system for threat data by CSIRTGadgets.org Integrates with tools such as:
- Splunk
- ELK
- Logstash
- ArcSight
If leveraging a number of databases and data sources, can be a useful tool to populate high confidence data to teams and tools using indicators to take action


---

# Section 4 : Analysis and Production of Intelligence 


